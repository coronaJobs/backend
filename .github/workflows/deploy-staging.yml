name: deploy-staging
on:
  push:
      branches:
        - 'development'

jobs:
  buildAndDeploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v1
    
    - name: Install Heroku Cli
      run: |
        curl https://cli-assets.heroku.com/install-ubuntu.sh | sh
      
    - name: Heroku Login
      run: |
        cat >~/.netrc <<EOF
        machine api.heroku.com
            login ${email}
            password ${api_key}
        machine git.heroku.com
            login ${email}
            password ${api_key}
        EOF
        
        heroku login
    
    - name: Build and push image
      run: |
        docker --help
        
